{# partials/records_table.html
   Responsibility: Renders the managed records table rows.
   Returned as an HTMX fragment after add/remove/delete actions.
   Target: #records-container (innerHTML swap).
#}

{% if records %}
<table>
  <thead>
    <tr>
      <th>Record</th>
      <th>DNS IP</th>
      <th>Status</th>
      <th>Updates</th>
      <th>Failures</th>
      <th>Last Checked</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for r in records %}
    <tr>
      <td class="record-name font-mono">{{ r.name }}</td>
      <td class="font-mono text-sm">{{ r.dns_ip }}</td>
      <td>
        {% if r.is_up_to_date is none %}
          <span class="badge badge-neutral">Unknown</span>
        {% elif r.is_up_to_date %}
          <span class="badge badge-ok">Up to date</span>
        {% else %}
          <span class="badge badge-warning">Needs update</span>
        {% endif %}
      </td>
      <td class="text-sm">{{ r.updates }}</td>
      <td class="text-sm">
        {% if r.failures >= 3 %}
          <span class="badge badge-error">{{ r.failures }}</span>
        {% elif r.failures > 0 %}
          <span class="badge badge-warning">{{ r.failures }}</span>
        {% else %}
          {{ r.failures }}
        {% endif %}
      </td>
      <td class="text-sm text-muted">{{ r.last_checked or 'â€”' }}</td>
      <td>
        <form hx-post="/remove-from-managed"
              hx-target="#records-container"
              hx-swap="innerHTML"
              hx-confirm="Remove {{ r.name }} from managed records?"
              hx-on:htmx:after-request="if(event.detail.successful) location.reload()"
              style="display:inline">
          <input type="hidden" name="record_name" value="{{ r.name }}">
          <button type="submit" class="btn btn-ghost btn-sm">Remove</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% if error_message is defined and error_message %}
<div class="alert alert-error mt-1">{{ error_message }}</div>
{% endif %}

{% else %}
<div style="padding: 1.25rem; color: #94a3b8; font-size: 0.875rem;">
  No records managed yet. Use the "All A-Records in Zone" table to add records.
</div>
{% endif %}
